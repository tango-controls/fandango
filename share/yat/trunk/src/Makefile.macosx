#------------------------------------------------------------------------------
# This file is part of the YAT library
#------------------------------------------------------------------------------
#
# Copyright (C) 2006-2010  Nicolas Leclercq, Synchrotron SOLEIL.
#
# The Libera Tango Device is free software; you can redistribute it and/or
# modify it under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 2 of the License, or (at your
# option) any later version.
#
# The Libera Tango Device is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General
# Public License for more details.
#
# You should have received a copy of the GNU General Public License along
# with this program; if not, write to the Free Software Foundation, Inc., 51
# Franklin St, Fifth Floor, Boston, MA 02110-1301 USA
#
# Contact:
#      Nicolas Leclercq
#      Synchrotron SOLEIL
#------------------------------------------------------------------------------

#=============================================================================
# ARCH_TYPE
#=============================================================================
# - i386   : build 32 bits libraries
# - x86_64 : build 64 bits libraries
#-----------------------------------------------------------------------------
#####> THIS IS SUPPOSED TO BE SPECIFIED BY XCODE: ARCH_TYPE = É

#=============================================================================
# PROJECT_TYPE
#=============================================================================
# - STATIC_LIB : your project is a static library (.a)
# - SHARED_LIB : your project is a shared library (.dylib)
#-----------------------------------------------------------------------------
#####> THIS IS SUPPOSED TO BE SPECIFIED BY XCODE: PROJECT_TYPE = É

#=============================================================================
# RELEASE_TYPE
#=============================================================================
# - DEBUG     : debug symbols - no optimization
# - OPTIMIZED : no debug symbols - optimization level set to O2
#-----------------------------------------------------------------------------
#####> THIS IS SUPPOSED TO BE SPECIFIED BY XCODE: RELEASE_TYPE = É

#=============================================================================
# PROJECT_NAME is the name of the library/device/exe you want to build
#=============================================================================
# - for a STATIC_LIB : PROJECT_NAME will be prefixed by 'lib'
# - for a SHARED_LIB : PROJECT_NAME will be prefixed by 'lib'
#-----------------------------------------------------------------------------
ifeq ($(RELEASE_TYPE),OPTIMIZED)
  PROJECT_NAME = YAT
else
  PROJECT_NAME = YATd
endif  

#=============================================================================
# INC_DIR_USER - user defined include paths
#=============================================================================
# - if TANGO_REQUIRED : TANGO include directories are automatically added
# - any PROJECT_TYPE : "../include" and "." are automatically added
#-----------------------------------------------------------------------------
#####> INC_DIR_USER = 

#=============================================================================
# LIB_DIR_USER - user defined library paths
#=============================================================================
# - if TANGO_REQUIRED : TANGO libraries directories are automatically added
# - any PROJECT_TYPE  : "../lib" is automatically added
#-----------------------------------------------------------------------------
#####> LIB_DIR_USER = <your library paths> 

#=============================================================================
# LDFLAGS_USER - linker options or user defined libraries
#=============================================================================
# - for a DEVICE     : the TANGO libraries are automatically added
# - any PROJECT_TYPE : '-ldl -lpthread' are automatically added
#-----------------------------------------------------------------------------
# - NOTE : Be aware that the order matters! For instance, if you link your 
#          project versus libA, and libA depends itself on libB, you must 
#          use '-lA -lB', you will get 'undefined reference' errors otherwise
#----------------------------------------------------------------------------
#####> LDFLAGS_USER  = <your linker options and/or libraries> 

#=============================================================================
# CXXFLAGS_USER - compiler options or user defined macros
#=============================================================================
# - NOTE : put your compile-time macros here using '-Dmy_macro'
#-----------------------------------------------------------------------------
CXXFLAGS_USER  = -DNoNanoSleep
CXXFLAGS_USER += -DPthreadDraftVersion=8 
CXXFLAGS_USER += -UPthreadSupportThreadPriority 
CXXFLAGS_USER += -UNeedPthreadInit
CXXFLAGS_USER += -fno-enforce-eh-specs -Wno-unused-parameter
ifeq ($(RELEASE_TYPE),DEBUG)
	CXXFLAGS_USER += -D_DEBUG
endif

#=============================================================================
#	TANGO.OPT - include standard TANGO compilation options
#=============================================================================
include ./build/macosx/tango.opt

#=============================================================================
# SVC_OBJS - is the list of all objects needed in order to build the project
#=============================================================================
SVC_OBJS = $(OBJ_DIR)/Exception.a.o \
					$(OBJ_DIR)/bitsstream/BitsStream.a.o \
					$(OBJ_DIR)/bitsstream/Endianness.a.o \
					$(OBJ_DIR)/network/Address.a.o \
					$(OBJ_DIR)/network/Socket.a.o \
					$(OBJ_DIR)/network/ClientSocket.a.o \
					$(OBJ_DIR)/network/SocketException.a.o \
					$(OBJ_DIR)/plugin/PlugIn.a.o \
					$(OBJ_DIR)/plugin/PlugInUnix.a.o \
					$(OBJ_DIR)/plugin/PlugInManager.a.o \
					$(OBJ_DIR)/threading/PosixThreadingImpl.a.o \
					$(OBJ_DIR)/threading/SharedObject.a.o \
					$(OBJ_DIR)/threading/Barrier.a.o \
					$(OBJ_DIR)/threading/Task.a.o \
					$(OBJ_DIR)/threading/Message.a.o \
					$(OBJ_DIR)/threading/MessageQ.a.o

#=============================================================================
# VERBOSE - comment the following line if you want a verbose compilation
#=============================================================================
.SILENT:

#=============================================================================
#	COMMON_TARGET.OPT - include standard TANGO compilation options
#=============================================================================
include ./build/macosx/common_target.opt

cleanall:
	make -f Makefile.macosx clean RELEASE_TYPE=OPTIMIZED PROJECT_TYPE=STATIC_LIB ARCH_TYPE=i386
	make -f Makefile.macosx clean RELEASE_TYPE=DEBUG PROJECT_TYPE=STATIC_LIB ARCH_TYPE=i386
	make -f Makefile.macosx clean RELEASE_TYPE=OPTIMIZED PROJECT_TYPE=SHARED_LIB ARCH_TYPE=i386
	make -f Makefile.macosx clean RELEASE_TYPE=DEBUG PROJECT_TYPE=SHARED_LIB ARCH_TYPE=i386
	make -f Makefile.macosx clean RELEASE_TYPE=OPTIMIZED PROJECT_TYPE=STATIC_LIB ARCH_TYPE=x86_64
	make -f Makefile.macosx clean RELEASE_TYPE=DEBUG PROJECT_TYPE=STATIC_LIB ARCH_TYPE=x86_64
	make -f Makefile.macosx clean RELEASE_TYPE=OPTIMIZED PROJECT_TYPE=SHARED_LIB ARCH_TYPE=x86_64
	make -f Makefile.macosx clean RELEASE_TYPE=DEBUG PROJECT_TYPE=SHARED_LIB ARCH_TYPE=x86_64
	
releases:
	make -f Makefile.macosx clean all RELEASE_TYPE=OPTIMIZED PROJECT_TYPE=STATIC_LIB ARCH_TYPE=i386
	make -f Makefile.macosx clean all RELEASE_TYPE=DEBUG PROJECT_TYPE=STATIC_LIB ARCH_TYPE=i386
	make -f Makefile.macosx clean all RELEASE_TYPE=OPTIMIZED PROJECT_TYPE=SHARED_LIB ARCH_TYPE=i386
	make -f Makefile.macosx clean all RELEASE_TYPE=DEBUG PROJECT_TYPE=SHARED_LIB ARCH_TYPE=i386
	make -f Makefile.macosx clean all RELEASE_TYPE=OPTIMIZED PROJECT_TYPE=STATIC_LIB ARCH_TYPE=x86_64
	make -f Makefile.macosx clean all RELEASE_TYPE=DEBUG PROJECT_TYPE=STATIC_LIB ARCH_TYPE=x86_64
	make -f Makefile.macosx clean all RELEASE_TYPE=OPTIMIZED PROJECT_TYPE=SHARED_LIB ARCH_TYPE=x86_64
	make -f Makefile.macosx clean all RELEASE_TYPE=DEBUG PROJECT_TYPE=SHARED_LIB ARCH_TYPE=x86_64



